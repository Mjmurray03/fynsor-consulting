# =============================================================================
# FYNSOR SECURITY CONFIGURATION
# =============================================================================
# This file contains security-related environment variables for Fynsor.
# Copy this file to .env.security and update the values for your environment.
# 
# CRITICAL: Never commit actual secrets to version control!
# Use secure secret management systems in production.
#
# SOC 2 Type II Compliance Ready
# GDPR/CCPA Compliant
# Zero-Trust Architecture
# =============================================================================

# =============================================================================
# ENCRYPTION CONFIGURATION
# =============================================================================

# Hardware Security Module (HSM) Configuration
# Enable HSM for enterprise-grade key management
HSM_ENABLED=false
HSM_PROVIDER=aws-cloudhsm
HSM_ENDPOINT=https://your-hsm-endpoint.cloudhsm.us-east-1.amazonaws.com
HSM_KEY_ID=your-hsm-key-id
HSM_KEY_STORE=fynsor-main-keystore
HSM_REGION=us-east-1
HSM_ACCESS_KEY_ID=your-hsm-access-key
HSM_SECRET_ACCESS_KEY=your-hsm-secret-key

# Diffie-Hellman Parameters for TLS
# Generate with: openssl dhparam -out dhparam.pem 4096
DH_PARAMS_PATH=/path/to/dhparam.pem

# =============================================================================
# AUTHENTICATION & AUTHORIZATION
# =============================================================================

# Session Configuration
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
SESSION_SECRET=your-ultra-secure-session-secret-64-chars-minimum-recommended

# Multi-Factor Authentication
MFA_ENABLED=true
MFA_ISSUER=Fynsor

# OAuth 2.0 Configuration
# Google OAuth
GOOGLE_OAUTH_CLIENT_ID=your-google-oauth-client-id.apps.googleusercontent.com
GOOGLE_OAUTH_CLIENT_SECRET=your-google-oauth-client-secret
GOOGLE_OAUTH_CALLBACK_URL=https://app.fynsor.com/auth/google/callback

# Microsoft OAuth
MICROSOFT_OAUTH_CLIENT_ID=your-microsoft-oauth-client-id
MICROSOFT_OAUTH_CLIENT_SECRET=your-microsoft-oauth-client-secret
MICROSOFT_OAUTH_CALLBACK_URL=https://app.fynsor.com/auth/microsoft/callback

# OAuth General Settings
OAUTH_REDIRECT_URI=https://app.fynsor.com/auth/callback

# IP Whitelisting
# Enable IP restrictions for high-value investor access
IP_WHITELIST_ENABLED=false
# Comma-separated list of allowed IP addresses
ALLOWED_IPS=192.168.1.100,10.0.0.50,203.0.113.10
# Special IP whitelist for high-value investors
HIGH_VALUE_INVESTOR_IPS=198.51.100.25,203.0.113.100

# =============================================================================
# DATA PROTECTION & PRIVACY
# =============================================================================

# GDPR Compliance
GDPR_ENABLED=true

# CCPA Compliance
CCPA_ENABLED=true

# Data Residency Controls
DATA_RESIDENCY_ENABLED=true
# Comma-separated list of allowed data regions
ALLOWED_DATA_REGIONS=us,eu,uk,ca
DEFAULT_DATA_REGION=us

# Data Retention Policies (in days)
# PII retention period (default: 7 years for financial services)
PII_RETENTION_DAYS=2555
# Audit log retention period
AUDIT_RETENTION_DAYS=2555

# =============================================================================
# COMPLIANCE & AUDITING
# =============================================================================

# SOC 2 Configuration
SOC2_ENABLED=true
SOC2_TYPE=type2
# SOC 2 reporting period in days (365 = annual)
SOC2_REPORTING_PERIOD=365
# SOC 2 audit frequency in days
SOC2_AUDIT_FREQUENCY=365

# Compliance Framework Enablement
ISO27001_ENABLED=false
NIST_ENABLED=true
PCI_ENABLED=false
HIPAA_ENABLED=false

# Automated Compliance Reporting
AUTOMATED_REPORTING=true
# Frequency: daily, weekly, monthly, quarterly
REPORTING_FREQUENCY=monthly
# Comma-separated list of report recipients
COMPLIANCE_REPORT_RECIPIENTS=compliance@fynsor.com,ciso@fynsor.com,audit@fynsor.com
ENCRYPT_COMPLIANCE_REPORTS=true

# Real-time Security Monitoring
REALTIME_MONITORING=true

# =============================================================================
# DATABASE SECURITY
# =============================================================================

# Database Connection Security
# Use encrypted connections and certificate verification
DB_SSL_MODE=require
DB_SSL_CERT_PATH=/path/to/client-cert.pem
DB_SSL_KEY_PATH=/path/to/client-key.pem
DB_SSL_CA_PATH=/path/to/ca-cert.pem

# Database Encryption at Rest
DB_ENCRYPTION_ENABLED=true
DB_ENCRYPTION_KEY_ID=your-database-encryption-key-id

# =============================================================================
# API SECURITY
# =============================================================================

# API Security Headers
API_RATE_LIMIT_ENABLED=true
API_RATE_LIMIT_WINDOW_MS=900000
API_RATE_LIMIT_MAX_REQUESTS=100

# CORS Configuration
CORS_ORIGIN=https://app.fynsor.com,https://admin.fynsor.com
CORS_CREDENTIALS=true

# API Keys for External Services
# Generate strong API keys for service-to-service communication
API_KEY_ENCRYPTION_SERVICE=your-encryption-service-api-key
API_KEY_AUDIT_SERVICE=your-audit-service-api-key
API_KEY_NOTIFICATION_SERVICE=your-notification-service-api-key

# =============================================================================
# SECURITY MONITORING & ALERTING
# =============================================================================

# Security Information and Event Management (SIEM)
SIEM_ENDPOINT=https://your-siem-endpoint.com/api/events
SIEM_API_KEY=your-siem-api-key
SIEM_ENABLED=true

# Security Operations Center (SOC) Integration
SOC_WEBHOOK_URL=https://your-soc-platform.com/webhooks/fynsor
SOC_API_KEY=your-soc-api-key

# Alert Notification Channels
# Email notifications
SECURITY_ALERT_EMAIL=security@fynsor.com
CISO_EMAIL=ciso@fynsor.com
CEO_EMAIL=ceo@fynsor.com

# Slack notifications
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/your/slack/webhook
SLACK_SECURITY_CHANNEL=#security-alerts

# SMS notifications (for critical alerts)
SMS_PROVIDER=twilio
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
SMS_SECURITY_NUMBERS=+1234567890,+1987654321

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================

# Backup Encryption
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_ENCRYPTION_KEY=your-backup-encryption-key

# Backup Storage
BACKUP_STORAGE_REGION=us-east-1
BACKUP_STORAGE_BUCKET=fynsor-secure-backups
BACKUP_RETENTION_DAYS=2555

# Disaster Recovery
DR_ENABLED=true
DR_REGION=us-west-2
DR_RTO_MINUTES=240
DR_RPO_MINUTES=60

# =============================================================================
# SECURITY TESTING
# =============================================================================

# Vulnerability Scanning
VULN_SCANNING_ENABLED=true
VULN_SCANNER_API_KEY=your-vulnerability-scanner-api-key
VULN_SCAN_FREQUENCY=weekly

# Penetration Testing
PENTEST_ENABLED=true
PENTEST_FREQUENCY=quarterly
PENTEST_PROVIDER=your-pentest-provider

# =============================================================================
# SECURITY HEADERS & BROWSER SECURITY
# =============================================================================

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_URI=/api/security/csp-report

# HTTP Strict Transport Security
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# =============================================================================
# ENVIRONMENT SPECIFIC
# =============================================================================

# Environment identifier
NODE_ENV=production
SECURITY_ENV=production

# Logging Level for Security Events
SECURITY_LOG_LEVEL=info
AUDIT_LOG_LEVEL=verbose

# Feature Flags for Security Features
ZERO_TRUST_ENABLED=true
ENDPOINT_DETECTION_ENABLED=true
BEHAVIORAL_ANALYTICS_ENABLED=true
THREAT_INTELLIGENCE_ENABLED=true

# =============================================================================
# THIRD-PARTY SECURITY INTEGRATIONS
# =============================================================================

# Cloud Security Posture Management (CSPM)
CSPM_ENABLED=true
CSPM_PROVIDER=your-cspm-provider
CSPM_API_KEY=your-cspm-api-key

# Identity and Access Management (IAM)
IAM_PROVIDER=okta
OKTA_DOMAIN=your-company.okta.com
OKTA_CLIENT_ID=your-okta-client-id
OKTA_CLIENT_SECRET=your-okta-client-secret

# Certificate Management
CERT_MANAGER_ENABLED=true
CERT_PROVIDER=letsencrypt
ACME_EMAIL=security@fynsor.com

# =============================================================================
# SECURITY METRICS & KPIs
# =============================================================================

# Security Metrics Collection
METRICS_ENABLED=true
METRICS_RETENTION_DAYS=365
METRICS_EXPORT_INTERVAL=300

# Security Dashboard
SECURITY_DASHBOARD_ENABLED=true
DASHBOARD_REFRESH_INTERVAL=60

# =============================================================================
# ADDITIONAL SECURITY CONFIGURATIONS
# =============================================================================

# Password Complexity Requirements
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_HISTORY_COUNT=12

# Account Lockout Policy
ACCOUNT_LOCKOUT_THRESHOLD=5
ACCOUNT_LOCKOUT_DURATION=1800
ACCOUNT_LOCKOUT_RESET_TIME=900

# Security Token Configuration
SECURITY_TOKEN_LENGTH=32
SECURITY_TOKEN_EXPIRY=3600
REFRESH_TOKEN_EXPIRY=2592000

# =============================================================================
# END OF CONFIGURATION
# =============================================================================

# Remember to:
# 1. Generate strong, unique values for all secrets
# 2. Use a secure secret management system in production
# 3. Regularly rotate keys and secrets
# 4. Monitor access to this configuration
# 5. Encrypt this file if storing in version control
# 6. Review and update security configurations regularly
# 7. Conduct security audits of these settings
# 8. Document any changes for compliance purposes